#!/bin/bash

# Set the initial version
VERSION_FILE="VERSION"
if [ ! -f $VERSION_FILE ]; then
    echo "1.0.0" > $VERSION_FILE
fi

# Read the current version
CURRENT_VERSION=$(cat $VERSION_FILE)

# Increment the patch version
IFS='.' read -r -a version_parts <<< "$CURRENT_VERSION"
major=${version_parts[0]}
minor=${version_parts[1]}
patch=${version_parts[2]}
new_patch=$((patch + 1))
NEW_VERSION="$major.$minor.$new_patch"

# Update the version in the VERSION file
echo $NEW_VERSION > $VERSION_FILE

# Update the Docker Compose file
sed -i "s/VERSION:.*/VERSION: $NEW_VERSION/g" docker-compose.yml

echo "Version updated to $NEW_VERSION"
